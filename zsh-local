# vim: set filetype=sh:

alias sd="if [ -f ./script/dbconsole ]; then ./script/dbconsole; else rails db; fi"
alias s3=/usr/local/bin/s3cmd
alias rd='(source .powenv;echo using port ${RUBY_DEBUG_PORT-20000};rdebug -c -p ${RUBY_DEBUG_PORT-20000})'

alias :e=vim

alias bb="afplay /System/Library/Sounds/Glass.aiff"

alias h=heroku
alias hh="heroku help"
alias aria='aria2c -s 10 -x 10 -k 1M'

alias vm=VBoxManage
alias tf=terraform

prompt fancy

DB_ENV_SH=~/.zsh/db_env.sh
if [ -e $DB_ENV_SH ]; then
  source $DB_ENV_SH
  db_local > /dev/null
fi

export RUBY_HEAP_MIN_SLOTS=1000000
export RUBY_GC_HEAP_INIT_SLOTS=1000000
export RUBY_HEAP_FREE_MIN=500000
export RUBY_HEAP_SLOTS_INCREMENT=1000000
export RUBY_HEAP_SLOTS_GROWTH_FACTOR=1
export RUBY_GC_MALLOC_LIMIT=100000000


AFILE=~/.zsh/aliases.sh
if [ -e $AFILE ]; then
  source $AFILE
fi
source ~/.zsh/docker.sh

# uncomment to log spring debug info
#export SPRING_LOG=/tmp/spring.log

if [ -e ~/.db.sh ]; then
  source ~/.db.sh
fi

function itermtheme() {
    (cd ~/d/; wget "https://raw.githubusercontent.com/mbadolato/iTerm2-Color-Schemes/master/schemes/$1.itermcolors")
    open ~/d/"$1".itermcolors
}


alias e=exercism

alias powlog="tail -f ~/Library/Logs/Pow/*.log ~/Library/Logs/Pow/*/*.log log/*.log"

test -e ${HOME}/.iterm2_shell_integration.zsh && source ${HOME}/.iterm2_shell_integration.zsh

function current_ruby() {
    local _ruby
    _ruby="$(chruby |grep \* |tr -d '* ')"
    if [[ $(chruby |grep -c \*) -eq 1 ]]; then
        echo ${_ruby}
    else
        echo "system"
    fi
}

# .env files autoloading
eval "$(direnv hook zsh)"
# make sure tmux doesn't load any of direnv stuff
alias tmux='direnv exec / tmux'

#load-nvmrc() {
#  if [[ -f .nvmrc && -r .nvmrc ]]; then
#    nvm use
#  fi
#}
#add-zsh-hook chpwd load-nvmrc

#alias iex='rlwrap -a foo iex'
